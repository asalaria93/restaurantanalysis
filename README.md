SQL Queries for Restaurant Data Analysis
This repository contains a collection of SQL queries designed to analyze restaurant order data. The queries cover various aspects such as revenue, ranking, customer behavior, and more.

SQL Queries

1. Find the Top 5 Most-Ordered Dishes from a Given Restaurant
SELECT restaurant_name, dish_name, SUM(order_value) AS total
FROM order_details
WHERE restaurant_name = 'restaurant_1'
GROUP BY restaurant_name, dish_name
ORDER BY total DESC
LIMIT 5;

Alternative approach using ROW_NUMBER():
SELECT * FROM (
    SELECT restaurant_name, dish_name, SUM(order_value) AS total,
           ROW_NUMBER() OVER (PARTITION BY restaurant_name ORDER BY SUM(order_value) DESC) AS ranking
    FROM order_details
    WHERE restaurant_name = 'restaurant_1'
    GROUP BY restaurant_name, dish_name
) AS famous_dishes
WHERE ranking <= 5;

2. Retrieve All Orders Placed in a Specific Date Range for a Specific User
SELECT order_id, customer_id, dish_name, order_date
FROM orders
WHERE customer_id = '195'
AND order_date BETWEEN '2024-09-09' AND '2024-10-19';


3. Find the Total Revenue Generated by All Restaurants for a Specific Month
WITH Date_month AS (
    SELECT * FROM order_details
    WHERE order_date BETWEEN '2024-09-01' AND '2024-10-31'
)
SELECT SUM(order_value) AS total_rev
FROM Date_month;

4. Retrieve the Top 10 Restaurants with the Highest Average Customer RatingSELECT restaurant_name, average_rating, ranking FROM (
    SELECT restaurant_name, average_rating,
           DENSE_RANK() OVER (ORDER BY average_rating DESC) AS ranking
    FROM order_details
    GROUP BY restaurant_name, average_rating
) AS restaurant_ranking
WHERE ranking <= 10;

5. List All Customers Who Have Ordered at Least One Dish from More Than 3 Different Restaurants
SELECT customer_id, COUNT(DISTINCT restaurant_id) AS dist_res
FROM orders
GROUP BY customer_id
HAVING dist_res > 3
ORDER BY dist_res DESC;

6. List All Customers Who Have Ordered at Least 2 Dishes from More Than 3 Different Restaurants
SELECT customer_id, COUNT(DISTINCT dish_name) AS dis_dish, COUNT(DISTINCT restaurant_id) AS dist_res
FROM orders
GROUP BY customer_id
HAVING dist_res > 3 AND dis_dish > 2
ORDER BY dist_res DESC;

7. Identify Restaurants Where the Average Order Value is Higher Than the Overall Average Order Value Across All Restaurants
WITH Total_value AS (
    SELECT restaurant_id, SUM(order_value) AS total_value, COUNT(dish_name) AS dish_count
    FROM orders
    GROUP BY restaurant_id
),
total_avg AS (
    SELECT AVG(order_value) AS total_avg FROM orders
),
res_avg AS (
    SELECT restaurant_id, total_value / dish_count AS res_avg
    FROM Total_value
    HAVING AVG(total_value) >= (SELECT AVG(order_value) FROM orders)
)
SELECT ra.restaurant_id, ra.res_avg, ta.total_avg,JOIN total_avg ta;
       CASE
           WHEN res_avg > total_avg THEN 'high_avg_orders'
           ELSE 'low_avg_orders'
       END AS High_value_restaurant
FROM res_avg ra
JOIN total_avg ta;

8. Group Orders by Cuisine Type and Calculate the Total Revenue for Each Cuisine
SELECT cuisine_type, SUM(order_value) AS total_rev  
FROM order_details
GROUP BY cuisine_type;

9. Find the Rank of Each Restaurant Based on Total Revenue Within Each City
SELECT restaurant_id, city, SUM(order_value) AS total_rev,
       DENSE_RANK() OVER (ORDER BY SUM(order_value) DESC) AS ranking
FROM order_details
GROUP BY restaurant_id, city;

10. Categorize Restaurants into "High Revenue," "Medium Revenue," and "Low Revenue" Based on Their Monthly Sales
WITH revbyres AS (
    SELECT restaurant_name, SUM(order_value) AS revby_res
    FROM order_details
    GROUP BY restaurant_name
), stddev AS (
    SELECT AVG(revby_res) AS res_avg,
           STDDEV(revby_res) AS std_dev
    FROM revbyres
)
SELECT rbr.restaurant_name, rbr.revby_res, sd.res_avg, sd.std_dev,
       CASE
           WHEN rbr.revby_res >= (sd.res_avg + sd.std_dev) THEN 'High Revenue'
           WHEN rbr.revby_res <= (sd.res_avg - sd.std_dev) THEN 'Low Revenue'
           ELSE 'Mid Revenue'
       END AS Restaurant_revenue
FROM revbyres rbr
JOIN stddev sd
ORDER BY revby_res DESC;




